---
title: "ã€React åˆå¿ƒè€…ã€‘React ã§æ–‡å­—å½“ã¦ã‚²ãƒ¼ãƒ ï¼"
date: 2020-05-31T12:00:00+09:00
lastmod: 2021-07-12T12:00:00+09:00
categories: [ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°, Web ã‚¢ãƒ—ãƒª]
tags: [React, ã‚¢ãƒ—ãƒªé–‹ç™º]
summary: "æœ€è¿‘ React ã‚’å‹‰å¼·ã—ã¦ã„ã¦ã€ä½•ã‹ç°¡å˜ãªã‚‚ã®ã‚’ä½œã‚ŠãŸã„ã¨æ€ã£ã¦ã€ã“ã®ã‚ˆã†ãªæ–‡å­—å½“ã¦ã‚²ãƒ¼ãƒ ã‚’ä½œã‚Šã¾ã—ãŸã€‚
<br/><br/>
ä»Šå›ã€ã“ã®è¨˜äº‹ã§å®Ÿè£…ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚
<br/><br/>
ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ props ã¯ã»ã¨ã‚“ã©ä½¿ã£ã¦ãŠã‚‰ãšã€"
draft: false
---

<br/>

æœ€è¿‘ React ã‚’å‹‰å¼·ã—ã¦ã„ã¦ã€ä½•ã‹ç°¡å˜ãªã‚‚ã®ã‚’ä½œã‚ŠãŸã„ã¨æ€ã£ã¦ã€ã“ã®ã‚ˆã†ãªæ–‡å­—å½“ã¦ã‚²ãƒ¼ãƒ ã‚’ä½œã‚Šã¾ã—ãŸã€‚

<tweet id="1266654890907930625" />

<br/>

{{< sandbox "react-typing-game" "https://codesandbox.io/s/react-typing-game-cn92x?fontsize=14&hidenavigation=1&theme=dark" >}}

ä»Šå›ã€ã“ã®è¨˜äº‹ã§å®Ÿè£…ã«ã¤ã„ã¦è§£èª¬ã—ã¦ã„ãã¾ã™ã€‚

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ props ã¯ã»ã¨ã‚“ã©ä½¿ã£ã¦ãŠã‚‰ãšã€

- JSX ã¨ã¯
- state ã¨ã¯
- ã©ã‚“ãªæ„Ÿã˜ã«æ›¸ã‘ã‚‹ã®ã‹

ãã‚‰ã„ã®äººå‘ã‘ã®è¨˜äº‹ã«ãªã‚‹ã‹ãªã¨æ€ã„ã¾ã™ã€‚

<br/>

## React ã®å°å…¥

React ã‚’ä½¿ã†ã«ã¯ [Node.js](https://nodejs.org/ja/) ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚

Node.js ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸå¾Œã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã«å…¥åŠ›ã™ã‚‹ã¨ã€

ã‚«ãƒ¬ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆä»Šã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ç›´ä¸‹ã«æ–°ãŸãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ`my-react-app`ï¼‰ãŒä½œã‚‰ã‚Œã¾ã™ã€‚

```bash hide_nums
npx create-react-app my-react-app
```

`my-react-app`ã®éƒ¨åˆ†ã¯å¥½ããªåå‰ã§å¤§ä¸ˆå¤«ã§ã™ã€‚

`cd my-react-app`ã§ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ç§»å‹•ã—ã¦ã‹ã‚‰ã€`npm start`ã™ã‚‹ã¨ã€

ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆãŒç«‹ã¡ä¸ŠãŒã‚Šã€ãƒ–ãƒ©ã‚¦ã‚¶ã§è¦‹ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

<br/>

## React ã®ä»•çµ„ã¿

React ã¯ **JavaScript ã§ HTML ã‚’æ›¸ã„ã¦ã—ã¾ãŠã†**ã¨ã„ã†ç™ºæƒ³ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

ãã®ä»•çµ„ã¿ã«ã¤ã„ã¦ã§ã™ãŒã€

ã•ãã»ã©ã®ã‚³ãƒãƒ³ãƒ‰ã§ä½œæˆã•ã‚ŒãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä¸­èº«ã‚’è¦‹ã¦ã¿ã‚‹ã¨ã€

`/public/index.html`ã¨`/src/index.js`ã¨ã„ã†ã®ãŒã‚ã‚Šã¾ã™ã€‚

```html name=/public/index.html hl_lines=4
...
<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root"></div>
  <!--
    This HTML file is a template.
    If you open it directly in the browser, you will see an empty page.

    You can add webfonts, meta tags, or analytics to this file.
    The build step will place the bundled scripts into the <body> tag.

    To begin the development, run `npm start` or `yarn start`.
    To create a production bundle, use `npm run build` or `yarn build`.
  -->
</body>
...
```

ã“ã® HTML ãƒ•ã‚¡ã‚¤ãƒ«ã®`<body>`ã‚¿ã‚°ã®ä¸­èº«ã¯ã‹ã‚‰ã£ã½ã§ã™ã€‚

ä¸­èº«ã‚’ JavaScript ã§ç”Ÿæˆã—ã¦ã€`<div id="root"></div>`ã®ä¸­ã«å…¥ã‚Œè¾¼ã‚€ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

```jsx name=/src/index.js hl_lines=7-12
import React from 'react';
import ReactDOM from 'react-dom';
import './index.css';
import App from './App';
import * as serviceWorker from './serviceWorker';

ReactDOM.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>,
  document.getElementById('root')
);

// If you want your app to work offline and load faster, you can change
// unregister() to register() below. Note this comes with some pitfalls.
// Learn more about service workers: https://bit.ly/CRA-PWA
serviceWorker.unregister();
```

`ReactDOM.render`ã«ã‚ˆã£ã¦ã€`id="root"`ã®ã‚¿ã‚°ã®ä¸­èº«ã«`<React.StrictMode><App /></React.StrictMode>`ãŒå…¥ã‚‹ã¨ã„ã†ä»•çµ„ã¿ã§ã™ã€‚

<br/>

ãã—ã¦ã€`<App />`ã®éƒ¨åˆ†ã«ã¯`/src/App.js`ã®å†…å®¹ãŒå±•é–‹ã•ã‚Œã¾ã™ã€‚

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æ§‹é€ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```jsx name=/src/App.js
import React, { Component } from 'react';
import './App.css';

export default class App extends Component {
  render() {
    return (

    );
  }
}
```

`Component`ã‚’ç¶™æ‰¿ã—ãŸ`App`ã¨ã„ã†ã‚¯ãƒ©ã‚¹ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ãŒã€

å®Ÿéš›ã«å±•é–‹ã•ã‚Œã‚‹ã®ã¯ã€`return`ã®ä¸­èº«ã«æ›¸ã‹ã‚ŒãŸ HTML ã£ã½ã„ã‚‚ã®ï¼JSX ã§ã™ã€‚

{{< relpos react-toha >}}

<br/>

## å®Ÿè£…

ã¾ãšã¯ç­”ãˆã¨ãªã‚Šã†ã‚‹æ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã€

ãã®ä¸­ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã§ç­”ãˆã‚’å–ã‚Šå‡ºã—ã¾ã™ã€‚

```jsx name=/src/App.js hl_lines=4,5
import React, { Component } from 'react';
import './App.css';

let answers = [...];  // ç­”ãˆã®ä¸€è¦§
let answer = answers[Math.floor(Math.random()*answers.length)];
```

æ¬¡ã« state ã‚’å®£è¨€ã—ã¾ã™ã€‚

**state ã¯ã€Œå¤–éƒ¨ã¨ã¯é–¢ã‚ã‚Šã®ãªã„ã€å¤‰æ•°**ã§ã™ã€‚

å¯¾ã—ã¦ props ã¯ã€é–¢æ•°ã®å¼•æ•°ã®ã‚ˆã†ã«ã€å¤–éƒ¨ã‹ã‚‰å®šç¾©ã§ãã‚‹å¤‰æ•°ã§ã™ãŒã€ä»Šå›ã¯ä½¿ã„ã¾ã›ã‚“ã€‚

```jsx name=/src/App.js hl_lines=9-17
import React, { Component } from 'react';
import './App.css';

let answers = [...];
let answer = answers[Math.floor(Math.random()*answers.length)];

export default class App extends Component {

  constructor(props) {
    super(props);
    this.state = {
      ans: answer,                          // ç­”ãˆã¨ãªã‚‹æ–‡å­—åˆ—
      display: '_'.repeat(answer.length),   // è¡¨ç¤ºã•ã›ã‚‹æ–‡å­—åˆ—
      inputted: '',   // å…¥åŠ›ã•ã‚ŒãŸã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆ
      correct: false  // æ­£è§£ãŒå‡ºãŸã‚‰ true
    };
  }
  ...
}
```

`constructor`ã¯ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚

`this`ã¯ã‚¯ãƒ©ã‚¹è‡ªä½“ã‚’æŒ‡ã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã§ã¨ã‚Šã‚ãˆãšã„ã„ã¨æ€ã„ã¾ã™ã€‚

<br/>

æ¬¡ã«å‡ºåŠ›ã™ã‚‹ HTML ã¨ãªã‚‹éƒ¨åˆ†ã‚’æ›¸ãã¾ã™ã€‚

```jsx name=/src/App.js hl_lines=3-14
...
render() {
  const { ans, display, correct } = this.state;

  return (
    <div className="main">
      <p>{correct ? 'Correct!' : ''}</p>
      <p className="answer">{display}</p>
      <div className="alphabets">
        {('abcdefghijklmnopqrstuvwxyz'.split('')).map(value => <button name={value} onClick={this.onInput}>{value}</button>)}
      </div>
      <button className="ans-btn" onClick={this.check}>å›ç­”</button>
      <button className="next-btn" onClick={() => this.reset(ans)}>æ¬¡ã®å•é¡Œ</button>
    </div>
  );
}
```

HTML ã‚’çŸ¥ã£ã¦ã„ã‚Œã°ã€å¾®å¦™ãªå·®ç•°ã¯ã‚ã‚‹ã‚‚ã®ã® JSX ã¯ãªã‚“ã¨ãªãèª­ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚

JSX ã®ä¸­ã«`{}`ã§æ›¸ã„ãŸéƒ¨åˆ†ã« JavaScript ã®ã‚³ãƒ¼ãƒ‰ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚

state ã‚’ä½¿ã†ã¨ãã«ã¯ï¼“è¡Œç›®ã®ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

10è¡Œç›®ã§ã¯ã€a-z ã¾ã§ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã‚’è¨˜ã—ãŸ26å€‹ã®ãƒœã‚¿ãƒ³ã‚’é…ç½®ã—ã¦ã„ã¾ã™ã€‚

### ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã®å‹•ä½œã®å®šç¾©

`onInput`ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãƒœã‚¿ãƒ³ãŒæŠ¼ã•ã‚ŒãŸã¨ãã«ã©ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãŒé¸æŠã•ã‚ŒãŸã®ã‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚

```jsx name=/src/App.js
onInput = e => {
  this.setState({
    inputted: e.target.name
  });
}
```

ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã®ãƒœã‚¿ãƒ³ã®`name`å±æ€§ã«ã¯å„ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãŒæŒ‡å®šã—ã¦ã‚ã‚‹ã®ã§ã€

ã“ã‚Œã‚’è¦‹ã‚‹ã“ã¨ã§ã©ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãŒé¸æŠã•ã‚ŒãŸã‹ãŒã‚ã‹ã‚Šã¾ã™ã€‚

<br/>

æ¬¡ã«ã€`check`ãƒ¡ã‚½ãƒƒãƒ‰ã§ç­”ãˆã®ä¸­ã«æŒ‡å®šã—ãŸã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã™ã€‚

ã“ã‚Œã¯ã€Œå›ç­”ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã«å‹•ä½œã—ã¾ã™ã€‚

```jsx name=/src/App.js
check = () => {
  const { ans, display, inputted } = this.state;
  let displayTmp = display;

  // ä¸€åº¦æŠ¼ã—ãŸãƒœã‚¿ãƒ³ã¯ç„¡åŠ¹åŒ–ã™ã‚‹
  document.getElementsByName(inputted)[0].disabled = true;
  
  if (~ans.indexOf(inputted)) {   // é¸æŠã—ãŸã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãŒç­”ãˆã«å«ã¾ã‚Œã¦ã„ã‚‹ã¨ã
    for (let k = 0;k <= ans.length-1;k++) {
      let letterIndex = ans.indexOf(inputted, k)
      if (~letterIndex && display[letterIndex] !== ans.charAt(letterIndex)) {
        // ä¸€è‡´ã—ãŸéƒ¨åˆ†ã‚’è¦‹ã›ã‚‹
        displayTmp = displayTmp.slice(0, letterIndex) + ans.charAt(letterIndex) + displayTmp.slice(letterIndex + 1);
      }
    }
    this.setState({
      display: displayTmp
    });
    if (displayTmp === ans) {
      this.setState({
        correct: true
      });
    }
  }
}
```

13è¡Œç›®ã®`displayTmp = ...`ã®éƒ¨åˆ†ã§`this.setState`ã‚’ã—ã¦ã‚‚ã€`for`ãƒ«ãƒ¼ãƒ—ãŒã†ã¾ãã„ãã¾ã›ã‚“ã§ã—ãŸã€‚

ãã®ãŸã‚ã€`displayTmp`ã‚’ä»®ã«ä½œã£ã¦ã‹ã‚‰ã€å¾Œã§`display`ã‚’å¤‰æ›´ã—ã¦ã„ã¾ã™ã€‚

<br/>

ã¡ãªã¿ã«ã€`~`ã¯ãƒ“ãƒƒãƒˆã‚’åè»¢ã™ã‚‹ã‚‚ã®ã§ã€`~-1`ãŒ`0`ã«ãªã‚Šã¾ã™ã€‚

`0`ãŒ`false`ã¨ã¿ãªã•ã‚Œã‚‹ã®ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚

<br/>

æœ€å¾Œã«ã€ã€Œæ¬¡ã®å•é¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã«å‹•ä½œã™ã‚‹`reset`ãƒ¡ã‚½ãƒƒãƒ‰ã§ã™ã€‚

åˆ¥ã®å•é¡Œã‚’å‡ºé¡Œã—ã¾ã™ãŒã€åŒã˜å•é¡Œã¯ï¼’åº¦ã¨å‡ºãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚

```jsx name=/src/App.js
reset = shown => {
  // ç­”ãˆã®ãƒªã‚¹ãƒˆã‹ã‚‰ã™ã§ã«å‡ºé¡Œã—ãŸç­”ãˆã‚’é™¤ã
  answers = answers.filter(n => n !== shown);
  // æ¬¡ã«å‡ºé¡Œã™ã‚‹å•é¡Œã®ç­”ãˆ
  answer = answers[Math.floor(Math.random()*answers.length)]

  // å‡ºã™å•é¡ŒãŒãªããªã£ãŸã¨ãã€ã€Œæ¬¡ã®å•é¡Œã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ãªã„ã‚ˆã†ã«ã™ã‚‹
  if (answers.length === 1) {
    document.getElementsByClassName('next-btn')[0].disabled = true;
  }

  // ã™ã¹ã¦ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹
  const buttons = document.getElementsByClassName('alphabets')[0].getElementsByTagName('button');

  for (let i = 0; i <= 25; i++) {
    buttons[i].disabled = false;
  }

  this.setState({
    ans: answer,
    display: '_'.repeat(answer.length),
    correct: false
  });
}
```

å¼•æ•°`shown`ãŒã€`render`å†…ã§`ans`ã‚’å—ã‘å–ã£ã¦ã„ã¾ã™ã®ã§ã€

`shown`ã«ã¯ãã®æ™‚ç‚¹ã§å‡ºé¡Œã•ã‚Œã¦ã„ã‚‹å•é¡Œã®ç­”ãˆã®æ–‡å­—åˆ—ãŒæ¸¡ã•ã‚Œã¾ã™ã€‚

<br/>

ä»¥ä¸Šã§å®Œæˆã«ãªã‚Šã¾ã™ã€‚

<details>
<summary>App.js ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å…¨æ–‡</summary><br/>

```jsx name=/src/App.js
import React, { Component } from 'react';
import './App.css';

let answers = ['tiger', 'kangaroo', 'giraffe'];
let answer = answers[Math.floor(Math.random()*answers.length)];

export default class App extends Component {

  constructor(props) {
    super(props);
    this.state = {
      ans: answer,
      display: '_'.repeat(answer.length),
      inputted: '',
      correct: false
    };
  }

  onInput = e => {
    this.setState({
      inputted: e.target.name
    });
  }

  check = () => {
    const { ans, display, inputted } = this.state;
    let displayTmp = display;

    document.getElementsByName(inputted)[0].disabled = true;
    
    if (~ans.indexOf(inputted)) {
      for (let k = 0;k <= ans.length-1;k++) {
        let letterIndex = ans.indexOf(inputted, k)
        if (~letterIndex && display[letterIndex] !== ans.charAt(letterIndex)) {
          displayTmp = displayTmp.slice(0, letterIndex) + ans.charAt(letterIndex) + displayTmp.slice(letterIndex + 1);
        }
      }
      this.setState({
        display: displayTmp
      });
      if (displayTmp === ans) {
        this.setState({
          correct: true
        });
      }
    }
  }

  reset = shown => {
    answers = answers.filter(n => n !== shown);
    answer = answers[Math.floor(Math.random()*answers.length)]

    if (answers.length === 1) {
      document.getElementsByClassName('next-btn')[0].disabled = true;
    }

    const buttons = document.getElementsByClassName('alphabets')[0].getElementsByTagName('button');

    for (let i = 0; i <= 25; i++) {
      buttons[i].disabled = false;
    }

    this.setState({
      ans: answer,
      display: '_'.repeat(answer.length),
      correct: false
    });
  }

  render() {
    const { ans, display, correct } = this.state;

    return (
      <div className="main">
        <p>{correct ? 'Correct!' : ''}</p>
        <p className="answer">{display}</p>
        <div className="alphabets">
          {('abcdefghijklmnopqrstuvwxyz'.split('')).map(value => <button name={value} onClick={this.onInput}>{value}</button>)}
        </div>
        <button className="ans-btn" onClick={this.check}>å›ç­”</button>
        <button className="next-btn" onClick={() => this.reset(ans)}>æ¬¡ã®å•é¡Œ</button>
      </div>
    );
  }
}
```

</details>

{{< relpos react-typing-app >}}

---

React ã¨ã„ã£ã¦ã‚‚ã€ã»ã¨ã‚“ã©ã¯ JavaScript ã®è©±ã«ãªã‚Šã¾ã—ãŸã€‚

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ props ã‚’ä½¿ãˆã°ã€ã‚‚ã£ã¨ React ã®æœ¬è³ªã«è¿‘ã¥ã‘ã‚‹ã‚ˆã†ãªæ°—ãŒã—ã¾ã™ã€‚

ã¨ã¯ã„ãˆã€ã‚„ã¯ã‚Š JSX ã§æ›¸ã‘ã‚‹ã“ã¨ã€ãã®ä¸­ã« JavaScript ã®ã‚³ãƒ¼ãƒ‰ã‚’åŸ‹ã‚è¾¼ã‚ã‚‹ã“ã¨ãŒä¾¿åˆ©ã§ã™ã­ã€‚

å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

ã§ã¯ã§ã¯ğŸ‘‹
