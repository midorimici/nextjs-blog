---
title: "【Hugo】ショートコードで複雑な HTML を簡潔に"
date: 2020-05-22T12:00:00+09:00
lastmod: 2021-08-14T12:00:00+09:00
topics: [サイト構築, Hugo, HTML]
published: true
---

<p><tltp label="Hugo">Go 製の静的サイトジェネレータ<br/>[公式サイト](https://gohugo.io)</tltp>ではショートコードという機能があり、</p>

これを使うことで複雑な HTML 構造も簡潔な形でマークダウン（.md）ファイルの中に記述することができるようになります。

今回は、ショートコードの使い方について書いていきます。

<!--more-->

<br/>

## ショートコードを設定する

`layouts/shortcodes`フォルダを作り（フォルダ名は任意ではない）、その中に HTML ファイルを作成します。

この HTML ファイル名が、ショートコードの名前になります。

HTML ファイル内には、ショートコードを使用したマークダウンファイル内で展開したい HTML を書きます。

ここでは例として、次のようなファイルを作成します。

```html name=/layouts/shortcodes/greet.html
<p>おはようございます。</p>
<p>今日の天気は晴れです。</p>
```

<br/>

## マークダウンファイルでショートコードを呼び出す

マークダウンファイルの中で、ショートコードの名前を使用して、次のように書くと、HTML が展開されます。

```go
{{< greet >}}
->
<p>おはようございます。</p>
<p>今日の天気は晴れです。</p>
```

ショートコードのファイルのほうにマークダウンの記法（**など）を使いたい場合は、`< >`は`% %`とします。

<br/>

## 引数を使用する

ショートコードに引数を追加して、HTML の中で使うこともできます。

HTML ファイルの中では、引数は`{{ .Get 0 }}`のように、引数の位置を指定することで取得できます。

```go name=/layouts/shortcodes/greet.html
{{- $name := .Get 0 -}}
{{- $weather := .Get 1 -}}
<p>おはようございます、{{ $name }}さん。</p>
<p>今日の天気は{{ $weather }}です。</p>
```

```go
{{< greet "サトウ" "雨" >}}
->
<p>おはようございます、サトウさん。</p>
<p>今日の天気は雨です。</p>
```

位置変数の他に、キーワード変数を指定することもできます。

ただし、位置変数とキーワード変数を同時に指定することはできません。

```go name=/layouts/shortcodes/greet.html
{{- $name := .Get "name" -}}
{{- $weather := .Get "weather" -}}
<p>おはようございます、{{ $name }}さん。</p>
<p>今日の天気は{{ $weather }}です。</p>
```

```go
{{< greet name="サイトウ" weather="曇り" >}}
->
<p>おはようございます、サイトウさん。</p>
<p>今日の天気は曇りです。</p>
```

`default`関数を使って、引数のデフォルト値を指定することもできます。

```go name=/layouts/shortcodes/greet.html
{{- $name := .Get "name" | default "タロウ" -}}
{{- $weather := .Get "weather" | default "晴れ" -}}
<p>おはようございます、{{ $name }}さん。</p>
<p>今日の天気は{{ $weather }}です。</p>
```

```go
{{< greet >}}
->
<p>おはようございます、タロウさん。</p>
<p>今日の天気は晴れです。</p>
```

<relpos link="hugo-scratch" />

<br/>

## タグで囲まれた範囲をショートコードとする

ショートコードの開始タグと終了タグで囲まれた範囲を取得することもできます。

内容は`{{ .Inner }}`で呼び出します。

```go name=/layouts/shortcodes/greet.html
<p>おはようございます。</p>
{{ .Inner }}
<p>調子はどうですか。</p>
```

```go
{{% greet %}}
本日はお日柄もよく、
**たいへん気持ちのいい朝**ですね。
{{% /greet %}}

->
<p>おはようございます。</p>
<p>本日はお日柄もよく、
<strong>たいへん気持ちのいい朝</strong>ですね。</p>
<p>調子はどうですか。</p>
```

こちらでも引数を指定することができます。

<br/>

## ショートコードをネストする

開始タグと終了タグを指定するブロック型のショートコードの中に、

別のブロック型ショートコードやインライン型ショートコードを入れることもできます。

```go name=/layouts/shortcodes/greet.html
おはようございます、
{{ .Inner }}
調子はどうですか。
```

```go name=/layouts/shortcodes/name-weather.html
{{ .Get "name" }}さん。
今日の天気は{{ .Get "weather" }}です。
```

```go
{{% greet %}}

{{% name-weather name="ジロウ" weather="快晴" %}}

{{% /greet %}}

->
<p>おはようございます、</p>
<p>ジロウさん。
今日の天気は快晴です。</p>
<p>調子はどうですか。</p>
```

`{{ .Parent }}`を使えば、親のショートコードから情報を取得することもできます。

```html name=/layouts/shortcodes/name-weather.html hl_lines=2
{{ .Get "name" }}さん。
{{ .Parent.Get 0 }}
今日の天気は{{ .Get "weather" }}です。
```

```go hl_lines=1,10 inline_hl=1:4
{{% greet "今日は暑いですね。" %}}

{{% name-weather name="ジロウ" weather="快晴" %}}

{{% /greet %}}

->
<p>おはようございます、</p>
<p>ジロウさん。
今日は暑いですね。
今日の天気は快晴です。</p>
<p>調子はどうですか。</p>
```


<relpos link="hugo-printf" />

---

この記事がお役に立てれば幸いです。

それでは👋
